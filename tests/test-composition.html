<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width"/>
<title>Test</title>
</head>
<body>
<script>

"use strict"

var loops = 100000,
	items_string_concat = {
		"NameActionLeft0": 1,
		"NameActionLeft1": 2,
		"NameActionLeft2": 3,
		"NameActionLeft3": 4,
		"NameActionLeft4": 5,
		"NameActionRight0": 6,
		"NameActionRight1": 7,
		"NameActionRight2": 8,
		"NameActionRight3": 9,
		"NameActionRight4": 10,
	},
	items_hash = [],
	HASH_PLAYER = 1,
	HASH_LEFT = 0 << 7,
	HASH_RIGHT = 1 << 7,
	HASH_WALK = 1 << 8,
	frame = 0

function test_string_concat( n )
{
	var name = "Name",
		action = "Action"

	name += action
	name += n % 2 ? "Left" : "Right"
	name += frame

	frame = ++frame % 5

	return items_string_concat[name]
}

function test_hash( n )
{
	var hash = HASH_PLAYER,
		action = HASH_WALK

	hash |= HASH_WALK
	hash |= n % 2 ? HASH_LEFT : HASH_RIGHT
	hash |= frame << 12

	frame = ++frame % 5

	return items_hash[hash]
}

function run_test_string_concat()
{
	var t = Date.now(),
		sum = 0

	for( var n = loops; n--; )
		sum += test_string_concat( n )

	return Date.now()-t+" ("+sum+")"
}

function run_test_hash()
{
	var t = Date.now(),
		sum = 0

	for( var n = loops; n--; )
		sum += test_hash( n )

	return Date.now()-t+" ("+sum+")"
}

function compare_tests()
{
	for( var n = loops; n--; )
	{
		frame = 0
		var a = test_string_concat( n )

		frame = 0
		var b = test_hash( n )

		if( a != b )
		{
			alert( n+" is not equal: "+a+" != "+b );
			return
		}
	}
}

function init()
{
	for( var id in items_string_concat )
	{
		var hash = HASH_PLAYER

		hash |= HASH_WALK
		hash |= id.indexOf( "Left" ) > -1 ? HASH_LEFT : HASH_RIGHT
		hash |= parseInt( id.substr( -1, 1 ) ) << 12

		items_hash[hash] = items_string_concat[id]
	}

	compare_tests()

	document.write(
		"time string concat: "+run_test_string_concat()+
		"<br/>"+
		"time hash: "+run_test_hash()+
		"<br/>"+
		"time string concat: "+run_test_string_concat()+
		"<br/>"+
		"time hash: "+run_test_hash()+
		"<br/>" )
}

window.onload = init

</script>
</body>
</html>
