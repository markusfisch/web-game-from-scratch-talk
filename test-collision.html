<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width"/>
<title>Test</title>
</head>
<body>
<script>

"use strict"

var M = Math,
	loops = 10000000,
	items = [],
	player = { x: 5, y: 0 }

function test_rect()
{
	var hits = 0,
		cx = .5,
		cy = .5,
		pl = player.x-cx,
		pt = player.y-cy,
		pr = player.x+cx,
		pb = player.y+cy

	for( var n = items.length; n--; )
	{
		var item = items[n],
			l = item.x-.5,
			t = item.y-.5,
			r = item.x+.5,
			b = item.y+.5

		if( pl < r &&
			pr > l &&
			pt < b &&
			pb > t )
			++hits
	}

	return hits
}

function test_sqrt()
{
	var hits = 0

	for( var n = items.length; n--; )
	{
		var item = items[n],
			dx = player.x-item.x,
			dy = player.y-item.y

		if( M.abs( dx ) < 1 &&
			M.abs( dy ) < 1 &&
			M.sqrt( dx*dx + dy*dy ) < 1 )
			++hits
	}

	return hits
}

function run_rect()
{
	var t = Date.now(),
		sum = 0

	for( var n = loops; n--; )
		sum += test_rect()

	return Date.now()-t+" ("+sum+")"
}

function run_sqrt()
{
	var t = Date.now(),
		sum = 0

	for( var n = loops; n--; )
		sum += test_sqrt()

	return Date.now()-t+" ("+sum+")"
}

function init()
{
	for( var n = 10; n--; )
		items[n] = { x: n, y: 0 }

	document.write(
		"time sqrt: "+run_sqrt()+
		"<br/>"+
		"time rect: "+run_rect()+
		"<br/>"+
		"time sqrt: "+run_sqrt()+
		"<br/>"+
		"time rect: "+run_rect()+
		"<br/>" )
}

window.onload = init

</script>
</body>
</html>
